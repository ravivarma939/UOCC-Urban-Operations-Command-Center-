server.port=8081
spring.application.name=api-gateway
spring.main.allow-bean-definition-overriding=true

# =======================
# JWT CONFIG
# =======================
jwt.secret=UrbanOpsSecretKey1234567890!@#$%^&*

jwt.expiration=3600000

# =======================
# ROUTE DEFINITIONS
# =======================
spring.cloud.gateway.server.webflux.routes[0].id=auth-service
spring.cloud.gateway.server.webflux.routes[0].uri=http://localhost:8090
spring.cloud.gateway.server.webflux.routes[0].predicates[0]=Path=/api/auth/**
spring.cloud.gateway.server.webflux.routes[0].filters[0]=StripPrefix=1

spring.cloud.gateway.server.webflux.routes[1].id=alert-service
spring.cloud.gateway.server.webflux.routes[1].uri=http://localhost:8091
spring.cloud.gateway.server.webflux.routes[1].predicates[0]=Path=/api/alerts/**
spring.cloud.gateway.server.webflux.routes[1].filters[0]=StripPrefix=1
spring.cloud.gateway.server.webflux.routes[1].filters[1]=JwtAuthFilter

spring.cloud.gateway.server.webflux.routes[2].id=traffic-service
spring.cloud.gateway.server.webflux.routes[2].uri=http://localhost:8092
spring.cloud.gateway.server.webflux.routes[2].predicates[0]=Path=/api/incidents/**
spring.cloud.gateway.server.webflux.routes[2].filters[0]=StripPrefix=1
spring.cloud.gateway.server.webflux.routes[2].filters[1]=JwtAuthFilter

spring.cloud.gateway.server.webflux.routes[3].id=power-service
spring.cloud.gateway.server.webflux.routes[3].uri=http://localhost:8093
spring.cloud.gateway.server.webflux.routes[3].predicates[0]=Path=/api/sensors/**
spring.cloud.gateway.server.webflux.routes[3].filters[0]=StripPrefix=1
spring.cloud.gateway.server.webflux.routes[3].filters[1]=JwtAuthFilter

spring.cloud.gateway.server.webflux.routes[4].id=cctv-service
spring.cloud.gateway.server.webflux.routes[4].uri=http://localhost:8094
spring.cloud.gateway.server.webflux.routes[4].predicates[0]=Path=/api/cameras/**
spring.cloud.gateway.server.webflux.routes[4].filters[0]=StripPrefix=1
spring.cloud.gateway.server.webflux.routes[4].filters[1]=JwtAuthFilter

spring.cloud.gateway.server.webflux.routes[5].id=traffic-predictions
spring.cloud.gateway.server.webflux.routes[5].uri=http://localhost:8092
spring.cloud.gateway.server.webflux.routes[5].predicates[0]=Path=/api/predictions/**
spring.cloud.gateway.server.webflux.routes[5].filters[0]=StripPrefix=1
spring.cloud.gateway.server.webflux.routes[5].filters[1]=JwtAuthFilter

# =======================
# GLOBAL CORS CONFIG
# =======================
spring.cloud.gateway.server.webflux.globalcors.cors-configurations[/**].allowed-origin-patterns=*
spring.cloud.gateway.server.webflux.globalcors.cors-configurations[/**].allowed-methods=*
spring.cloud.gateway.server.webflux.globalcors.cors-configurations[/**].allowed-headers=*
spring.cloud.gateway.server.webflux.globalcors.cors-configurations[/**].exposed-headers=Authorization
spring.cloud.gateway.server.webflux.globalcors.cors-configurations[/**].allow-credentials=true

# =======================
# LOGGING
# =======================
logging.level.org.springframework.cloud.gateway=DEBUG
logging.level.com.traffic_service.gateway_service.filter=DEBUG

# =======================
# SECURITY
# =======================
spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.security.reactive.ReactiveUserDetailsServiceAutoConfiguration
